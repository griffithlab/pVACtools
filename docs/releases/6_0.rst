Version 6.0
===========

Version 6.0.0
-------------

This is a major version release. Please note that pVACtools 6.0 is not guaranteed to be
backwards-compatible and certain changes could break old workflows. It also
removes support for Python 3.7 and 3.8.

New Tools
_________

- A new tool, pVACcompare allows users to visualize differences between output
  files from different pVACtools versions. This tool may be useful when
  investigating changes to predicted neoantigens between versions in
  controlled experiments where enumerating and explaning such differences may be
  crucial, e.g. in clinical trials. The tool can be run using the ``pvactools
  compare`` command. For more information please see the
  `Comparison Tool documentation
  <https://pvactools.readthedocs.io/en/staging/helper_tools/comparison_tool.html>`_.
- A new standalone command ``pvacseq create_peptide_ordering_form`` generates
  peptide ordering files (FASTA, annotated ordering Excel spreadsheet,
  and review template Excel spreadsheet) to streamline preparation of peptides
  for synthesis and review. For more information please see the `documentation
  <https://pvactools.readthedocs.io/en/latest/pvacseq/optional_downstream_analysis_tools.html#create-peptide-ordering-form>`_

New Features
____________

- pVACseq and pVACsplice now take into account the MANE Select and Canonical status of a transcript
  for filtering, prioritizing, and tiering a neoantigen candidate. MANE Select, Canonical, and TSL
  status is evaluated according to the new ``--transcript-prioritization-strategy`` parameter. This
  parameter allows users to list one or more critieria (``mane_select``, ``canonical``, ``tsl``) to
  take into consideration. As part of this update the "transcript support level filter" has been
  renamed to "transcript filter" including the standalone command which is now
  ``pvacseq|pvacsplice transcript_filer`` instead of ``pvacseq|pvacsplice transcript_support_level_filter``.
- The aggregate report tiers have been updated to add four new tier:

  - ``PoorBinder``: candidate fails the binding criteria but passes all other critieria.
  - ``RefMatch``: candidate has a reference match but passes all other criteria.
  - ``ProbPos``: candidate has a problematic amino acid but passes all other criteria.
  - ``PoorTranscript``: a candidate's best transcript is neither MANE Select, Canonical, nor meets
    the TSL cutoff (depending on the specified ``transcript-prioritization-strategy``; only available
    in pVACseq and pVACsplice).

- A new set of standalone commands, ``pvacseq|fuse|splice|bind update_tiers``,
  has been added to update the tiering in an aggregate report if different
  tiering thresholds are desired after the initial pipeline run.
- By default, transcripts where the FLAGS VEP annotation is set will now be filtered out before processing
  by pVACseq and pVACsplice. This field identifies transcripts where the CDS 5' or 3' is incomplete. A new
  parameter ``--allow-incomplete-transcripts`` has been added which can be used to replicate the previous
  behavior where such transcripts were included.
- The pVACsplice logic for aggregating variants in the aggregate report creation has been updated to
  aggregate neoantigen candidates from the same Junction together instead of using the Index.
- Output file names of the reports have been updated to include MHC_I/MHC_II/Combined prefixes for easier
  identification of the type of output file.

Bugfixes
________

- This relase fixes a bug with sorting of pVACfuse output files.

Version 6.0.1
-------------

This is a bugfix release. It fixes the following problem(s):

* Ensure that the top_score_metric2 parameter is passed through to UpdateTiers so that the aggregate report gets sorted correctly. by @susannasiebert in https://github.com/griffithlab/pVACtools/pull/1335

Version 6.0.2
-------------

This is a bugfix release. It fixes the following problem(s):

* Define transcript set in the pVACsplice top score filter on Junction, not Index, in order to be consistent with the aggregate report. by @susannasiebert in https://github.com/griffithlab/pVACtools/pull/1340
* Fix some bugs with the `pvacseq create_peptide_ordering_form` command by using the Index to construct the 51mer ID instead of modifying the AA change. by @susannasiebert in https://github.com/griffithlab/pVACtools/pull/1341

Version 6.0.3
-------------

This is a bugfix release. It fixes the following problem(s):

* Remove allele no longer supported by MHCflurry. by @susannasiebert in https://github.com/griffithlab/pVACtools/pull/1342
